# 8 경계
- 모든 소프트웨어를 직접 개발하는 경우는 드물다.
- 외부 코드를 우리 코드에 깔끔히 통합시키려면 어떻게 해야할까?

## 외부 코드 사용하기
- 제공자는 적용성을 넓히기 위해, 사용자는 요구에 집중하기 위해 코드를 작성하며 문제가 발생한다.
### ex) java.util.Map
```Java
// (1)
Map sensors = new HashMap();
Sensor s = (Sensor) sensors.get(sensorId);

// (2)
Map<String, Sensor> sensors = new HashMap<>();
Sensor s = sensors.get(sensorId);
```
- (1) 과 같은 코드의 경우 올바른 유형으로 변환할 책임이 클라이언트로 향해 코드의 의도가 뚜렷하게 보이지 않는다.
- (2) 와 같은 제네릭스를 사용하면 가독성은 크게 높아지지만 사용자에게 필요없는 기능까지 제공한다는 단점이 있다.
    - 선언된 Map 을 여기저기로 넘기면 인터페이스가 변경됐을 때 수정할 부분이 많아진다.

```Java
// (3)
public class Sensors {
    private Map sensors = new HashMap();
    
    public Sensor getById(String id) {
        return (Sensor) sensors.get(id);
    }
}
```
- (3) 처럼 코드를 작성하면
    - Map은 Sensors 내로 숨겨지면서 Map 인터페이스가 변경되더라도 프로그램에 영향을 미치지 않는다.
    - Sensors 클래스는 프로그램에 필요한 인터페이스만 제공하게 되어 설계 규칙과 비즈니스 규칙을 따르도록 강제할 수 있다.


- 중요한 점은 Map과 같은 경계 인터페이스를 여기저기로 넘겨서는 안된다.
- 경계 인터페이스를 사용할 때는 사용하는 클래스나 클래스 계열 밖으로 내보내지 않아야한다.

## 경계 살피고 익히기
- 외부 패키지여도 사용할 코드를 테스트하는 편이 바람직하다.
- 간단한 테스트 케이스를 작성해 외부코드를 익히고 내부 코드에 적용한다.
    - 이를 **학습 테스트** 라고 한다.
- 학습 테스트는 API를 사용하려는 목적에 초첨을 맞춘다.

## log4j 익히기

## 학습 테스트는 공짜 이상이다
- 학습 테스트는 이해도를 높여주는 정확한 실험이다.
- 학습 테스트 작성으로 코드의 변경이 있을 때 기능이 그대로 동작하는지 확인할 수 있다.

## 아직 존재하지 않는 코드를 사용하기
- 아는 코드와 모르는 코드를 분리해야한다.
- 원하는 인터페이스를 구현하고, 통제해 코드의 의도를 뚜렷하게 만들어라.
- ADAPTER 패턴으로 API 사용을 캡슐화해 수정을 한곳에 모아라.

## 깨끗한 경계
- 경계에 위치하는 코드는 깔끔히 분리해야한다.
- 기대치를 정의하는 테스트 케이스도 작성해야한다.
- 새로운 클래스로 경계를 감싸거나 ADAPTER 패턴을 사용해 원하는 인터페이스 패키지가 제공하는 인터페이스로 변환해라.