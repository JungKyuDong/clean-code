# 7 오류 처리

- 오류 처리 코드로 인해 프로그램 논리를 이해하기 어려워진다면 깨끗한 코드가 아니다.

## 오류 코드보다 예외를 사용하라
> ### Error 와 Exception
>-  Error: 시스템이 종료되어야 할 수준과 같이 수습할 수 없는 심각한 문제를 의미
> -  Exception: 개발자가 미리 예측하여 방지할 수 있는 문제를 의미

- 오류는 계속 체크할 수 없기 때문에 예상되는 오류는 예외로 던지는게 호출자 코드가 깔끔해진다.

## Try-Catch-Finally 문부터 작성하라
- try-catch 사용시 try 내에서 예외가 발생하면 어느 시점에서든 catch 블록으로 넘어갈 수 있다.
- catch 블록은 프로그램 상태를 일관성 있게 유지해야하기 때문에 예외가 발생할 코드를 작성할 때는 try-catch 문부터 작성하는게 좋다.
- TDD를 사용해 예외가 맞게 발생하는지 확인할 필요가 있다.

## 미확인(unchecked) 예외를 사용하라
> ### 확인된 예외(checked exception) 와 미확인 예외(unchecked exception)
> - 확인된 예외: 컴파일 단계에서 발생해 무조건 처리해줘야하는 오류
    >   - RuntimeException 이외의 예외
> - 미확인 예외: 개발자가 판단해 처리해야하는 예외
    >   - RuntimeException 에 포함된 예외
> 

- 확인된 예외는 OCP를 위반한다.
  - 하위 단계에서 코드를 변경하면 상위 단계에서 메서드 선언문을 고쳐야한다.
  - throws 경로에 위치하는 모든 함수가 최하위에서 던지는 예외를 알아야해 캡슐화가 깨진다.
- 확인된 예외는 중요한 라이브러리 등에 사용하는게 좋다.

## 예외에 의미를 제공하라
- 예외를 작성할 때는 전후 상황을 충분히 덧붙여라.
- 오류 메세지에 실패한 연산의 이름, 유형을 작성해야 문제를 파악하기 쉽다

## 호출자를 고려해 예외 클래스를 정의하라
- 오류를 정의할 때 가장 중요한 관심사는 오류를 잡아내는 방법이 되어야한다.
- 외부 API를 감싸서 예외를 발생시키는게 깨끗한 코드를 만들 수 있다.

## 정상 흐름을 정의하라
- 비즈니스 논리와 오류 처리가 잘 분리된 코드를 작성해야한다.
- 예외가 논리를 따라가기 어렵게 만드는 경우 클래스를 만들거나 객체를 조작해 특수 사례를 처리한다.
  - 클라이언트 코드가 예외적인 상황을 처리할 필요가 없어지고 클래스나 객체는 예외상황을 캡슐화해 클린한 코드 작성이 가능해진다.

## null을 반환하지 마라
- null 체크가 많을수록 어느 부분에서 NPE가 발생했는지 찾기 어려워진다.
- null을 반환한다면 감싸기 메서드나 특수 사례 객체 반환 방식을 사용해 해결하는게 좋다.

## null을 전달하지 마라
- 정상적인 인수로 null을 기대하는 api가 아니라면 메서드로 null을 전달하지 말아야한다.

## 결론
- 코드는 깨끗해야하고, 안정성이 높아야한다.
- 오류 처리를 프로그램 논리와 분리해 독자적인 사안으로 고려해야한다.
